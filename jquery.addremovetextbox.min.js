/*
 * AddRemoveTextbox v1.0
 * https://www.github.com/kloverde/jquery-AddRemoveTextbox
 *
 * This software is licensed under the 3-clause BSD license.
 *
 * Copyright (c) 2016 Kurtis LoVerde
 * All rights reserved
 *
 * Donations:  https://paypal.me/KurtisLoVerde/5
 */
!function(a){"use strict";a.fn.addRemoveTextbox=function(b){function h(a){throw"AddRemoveTextbox error:  "+a}function i(b){var e=a("input[id^='"+d+"']");null!=c.maxFields&&e.length>c.maxFields&&h("There are more fields in the '"+d+"' set ("+e.length+") than are allowed by maxFields ("+c.maxFields+")"),e.each(function(){var b=a(this),c=b.parent();l().insertAfter(b),c.is(":last-child")&&k().appendTo(c)})}function j(b,c){var d=a("<span></span>");return null!=b&&d.addClass(b),null!=c&&d.prop("title",c),d.on("click",function(){}),d}function k(){var b=j(c.addButtonClass,c.addButtonTooltip);return b.on("click",function(){var b=n(a(this));a(q("#"+b)).focus()}),b}function l(){var b=j(c.removeButtonClass,c.removeButtonTooltip);return b.on("click",function(){p(a(this))}),b}function m(){var b=null,c=null,e=a("input[id^='"+d+"']");return e.each(function(){var d=a(this);null==b&&(b=d),c=d,b.attr("id")>d.attr("id")||(b=d)}),{highestBox:b,lastBox:c,numBoxes:e.length}}function n(a){var b=a.parent(),d=b.clone(!0),e=d.children("input"),f=o();return e.val(""),e.attr("id",f.nextId),e.attr("name",e.attr("id")),a.remove(),null!=c.maxFields&&f.numBoxes+1>=c.maxFields&&d.find("span[class='"+c.addButtonClass+"']").remove(),d.insertAfter(b),f.nextId}function o(){var a=m();null!=c.maxFields&&a.numBoxes>=c.maxFields&&h("Field count limit reached for "+d);var b=a.highestBox,e=parseInt(b.attr("id").replace(/.*(\d+).*$/,"$1")),g=e+1,i=f?d+"["+g+"]":d+g;return{nextId:i,numBoxes:a.numBoxes}}function p(b){var e=b.parent(),f=e.prev(),g=e.children("input").attr("id"),h=!1;a("input[id^='"+d+"']").each(function(){if(a(this).attr("id")!==g)return void(h=!0)}),h?(e.is(":last-child")?k().appendTo(f):e.parent().last().find("span[class='"+c.addButtonClass+"']").length||k().appendTo(e.siblings(":last")),e.remove()):a(q("#"+g)).val("")}function q(a){return a.replace(/(\[|\])/g,"\\$1")}var c=a.extend({addButtonClass:"addButton",addButtonTooltip:null,removeButtonClass:"removeButton",removeButtonTooltip:null,maxFields:null},b),d=this.attr("id").replace(/\[?[0-9]*\]?$/,""),e=null!=this.attr("id").match(/[0-9]+$/),f=null!=this.attr("id").match(/\[[0-9]\]$/);if(e||f?e&&f&&h("Invalid state: ID '"+this.attr("id")+"' notation not detected correctly"):h("Invalid ID attribute '"+this.attr("id")+"': IDs must be nunmbered like id1, id2, or use array notation, like id[0], id[1]"),null!=c.maxFields){var g="maxFields ("+c.maxFields+") must be an integer greater than 1";isNaN(c.maxFields)?h(g):(c.maxField=parseInt(c.maxField),(c.maxFields<2||c.maxFields%1!==0)&&h(g))}i(this)}}(jQuery);